const sidebarTitlesArray = [
  [true, 'ğŸ’» ç½‘ç«™é¦–é¡µ', "replace('home.html'); "],
  [false, 'ğŸ“ ä¸ªäººé¡¹ç›®', [
    [true, 'ğŸ“„ å°å­¦æˆé•¿çºªå¿µå†Œ', "replace('projects/q61.html')"]
  ]],
  [false, 'ğŸ“š å­¦ä¹ ç¬”è®°', [
    [false, 'ğŸ“ ä¸ƒå¹´çº§ä¸Šå­¦æœŸ', [
      [false, 'ğŸ“ è¯­æ–‡', [
        [true, 'ğŸ“˜ ç¬¬ä¸€å•å…ƒ', "replace('studyNoteFiles/grade71/chinese/unit1.html'); "],
        [true, 'ğŸ“˜ ç¬¬äºŒå•å…ƒ', ""],
        [true, 'ğŸ“˜ ç¬¬ä¸‰å•å…ƒ', ""],
        [true, 'ğŸ“˜ ç¬¬å››å•å…ƒ', ""],
        [true, 'ğŸ“˜ ç¬¬äº”å•å…ƒ', ""],
        [true, 'ğŸ“˜ ç¬¬å…­å•å…ƒ', ""],
        [true, 'ğŸ“˜ ç¬¬ä¸ƒå•å…ƒ', ""],
        [true, 'ğŸ“˜ ç¬¬å…«å•å…ƒ', ""]
      ]],
      [false, 'ğŸ“ æ•°å­¦', [
        [true, 'ğŸ“˜ ç¬¬ä¸€å•å…ƒ', ""],
        [true, 'ğŸ“˜ ç¬¬äºŒå•å…ƒ', ""],
        [true, 'ğŸ“˜ ç¬¬ä¸‰å•å…ƒ', ""],
        [true, 'ğŸ“˜ ç¬¬å››å•å…ƒ', ""],
        [true, 'ğŸ“˜ ç¬¬äº”å•å…ƒ', ""],
        [true, 'ğŸ“˜ ç¬¬å…­å•å…ƒ', ""]
      ]]
    ]],
  ]],
  [false, 'ğŸ“” ç¼–ç¨‹ç¬”è®°', [
    [false, 'ğŸ“ Python', [
      [false, 'ğŸ“ Numpy', [
        [false, 'ğŸ“ åˆçº§æ•™ç¨‹', [
          [true, 'ğŸ“˜ å®‰è£…å’Œå¯¼å…¥', "replace('programmingNoteFiles/Python/Numpy/1/1.html'); "],
          [true, 'ğŸ“˜ åˆ›å»ºæ•°ç»„', "replace('programmingNoteFiles/Python/Numpy/1/2.html'); "],
          [true, 'ğŸ“˜ ç´¢å¼•å’Œåˆ‡ç‰‡', "replace('programmingNoteFiles/Python/Numpy/1/3.html'); "],
          [true, 'ğŸ“˜ æ•°ç»„çš„è¿ç®—', "replace('programmingNoteFiles/Python/Numpy/1/4.html'); "],
          [true, 'ğŸ“˜ æ•°ç»„å½¢çŠ¶æ“ä½œ', "replace('programmingNoteFiles/Python/Numpy/1/5.html'); "],
          [true, 'ğŸ“˜ éšæœºæ•°ç”Ÿæˆ', "replace('programmingNoteFiles/Python/Numpy/1/6.html'); "],
          [true, 'ğŸ“˜ è¿›é˜¶æ“ä½œ', "replace('programmingNoteFiles/Python/Numpy/1/7.html'); "]
        ]],
        [false, 'ğŸ“ é«˜çº§æ•™ç¨‹', [
          [true, 'ğŸ“˜ è§†å›¾ä¸å‰¯æœ¬', "replace('programmingNoteFiles/Python/Numpy/2/1.html'); "],
          [true, 'ğŸ“˜ å¹¿æ’­æœºåˆ¶', "replace('programmingNoteFiles/Python/Numpy/2/2.html'); "],
          [true, 'ğŸ“˜ é«˜çº§èŠ±å¼ç´¢å¼•', "replace('programmingNoteFiles/Python/Numpy/2/3.html'); "],
          [true, 'ğŸ“˜ ç»“æ„åŒ–æ•°ç»„', "replace('programmingNoteFiles/Python/Numpy/2/4.html'); "],
          [true, 'ğŸ“˜ é€šç”¨å‡½æ•°æŠ€å·§', "replace('programmingNoteFiles/Python/Numpy/2/5.html'); "],
          [true, 'ğŸ“˜ æ€§èƒ½ä¼˜åŒ–æŠ€å·§', "replace('programmingNoteFiles/Python/Numpy/2/6.html'); "]
        ]]
      ]],
      [false, 'ğŸ“ Pandas', [
        [true, 'ğŸ“˜ å®‰è£…ä¸å¯¼å…¥', "replace('programmingNoteFiles/Python/Pandas/1.html'); "],
        [true, 'ğŸ“˜ ä¸¤å¤§æ•°æ®ç»“æ„', "replace('programmingNoteFiles/Python/Pandas/2.html'); "],
        [true, 'ğŸ“˜ è¯»å–ä¸å†™å…¥', "replace('programmingNoteFiles/Python/Pandas/3.html'); "],
        [true, 'ğŸ“˜ æ£€æŸ¥ä¸æ¦‚è§ˆ', "replace('programmingNoteFiles/Python/Pandas/4.html'); "],
        [true, 'ğŸ“˜ æŒ‘é€‰ä¸åˆ‡ç‰‡', "replace('programmingNoteFiles/Python/Pandas/5.html'); "],
        [true, 'ğŸ“˜ æ¸…æ´—ä¸æ•´ç†', "replace('programmingNoteFiles/Python/Pandas/6.html'); "],
        [true, 'ğŸ“˜ æ’åºä¸ç­›é€‰', "replace('programmingNoteFiles/Python/Pandas/7.html'); "],
        [true, 'ğŸ“˜ è®¡ç®—ä¸åˆ†ç»„', "replace('programmingNoteFiles/Python/Pandas/8.html'); "],
        [true, 'ğŸ“˜ åˆå¹¶ä¸è¿æ¥', "replace('programmingNoteFiles/Python/Pandas/9.html'); "],
        [true, 'ğŸ“˜ æ—¶é—´åºåˆ—å¤„ç†', "replace('programmingNoteFiles/Python/Pandas/10.html'); "],
        [true, 'ğŸ“˜ æ•°æ®å¯è§†åŒ–', "replace('programmingNoteFiles/Python/Pandas/11.html'); "]
      ]],
      [false, 'ğŸ“ Matplotlib', [
        [true, 'ğŸ“˜ å®‰è£…ä¸å¯¼å…¥', "replace('programmingNoteFiles/Python/Matplotlib/1.html'); "],
        [true, 'ğŸ“˜ ç¬¬ä¸€ä¸ªå›¾è¡¨', "replace('programmingNoteFiles/Python/Matplotlib/2.html'); "],
        [true, 'ğŸ“˜ æ·»åŠ åˆçº§å…ƒç´ ', "replace('programmingNoteFiles/Python/Matplotlib/3.html'); "],
        [true, 'ğŸ“˜ å›¾è¡¨ç±»å‹', "replace('programmingNoteFiles/Python/Matplotlib/4.html'); "],
        [true, 'ğŸ“˜ é¢å‘å¯¹è±¡æ¥å£', "replace('programmingNoteFiles/Python/Matplotlib/5.html'); "],
        [true, 'ğŸ“˜ ä¸Pandasçš„é›†æˆ', "replace('programmingNoteFiles/Python/Matplotlib/6.html'); "],
        [true, 'ğŸ“˜ é«˜çº§æŠ€å·§', "replace('programmingNoteFiles/Python/Matplotlib/7.html'); "],
        [true, 'ğŸ“˜ ç»¼åˆå®è·µ', "replace('programmingNoteFiles/Python/Matplotlib/8.html'); "]
      ]],
      [false, 'ğŸ“ Seaborn', [
        [true, 'ğŸ“˜ å®‰è£…å’Œå¯¼å…¥', "replace('programmingNoteFiles/Python/Seaborn/1.html'); "],
        [true, 'ğŸ“˜ ä»£ç æ¡†æ¶', "replace('programmingNoteFiles/Python/Seaborn/2.html'); "],
        [true, 'ğŸ“˜ åˆçº§ç»˜å›¾', "replace('programmingNoteFiles/Python/Seaborn/3.html'); "],
        [true, 'ğŸ“˜ é«˜çº§ç»˜å›¾', "replace('programmingNoteFiles/Python/Seaborn/4.html'); "],
        [true, 'ğŸ“˜ ç²¾ç»†åŒ–æ ·å¼æ§åˆ¶', "replace('programmingNoteFiles/Python/Seaborn/5.html'); "],
        [true, 'ğŸ“˜ ä¸Pandasçš„é›†æˆ', "replace('programmingNoteFiles/Python/Seaborn/6.html'); "],
        [true, 'ğŸ“˜ å®æˆ˜æ¡ˆä¾‹', "replace('programmingNoteFiles/Python/Seaborn/7.html'); "]
      ]],
      [false, 'ğŸ“ Scikit-learn', [
        [true, 'ğŸ“˜ å®‰è£…å’Œå¯¼å…¥', ""]
      ]],
      [false, 'ğŸ“ PySide6', [
        [false, 'ğŸ“ åˆçº§æ•™ç¨‹', [
          [true, 'ğŸ“˜ å‡†å¤‡å·¥ä½œ', "replace('programmingNoteFiles/Python/PySide6/1/1.html'); "],
          [true, 'ğŸ“˜ ä¿¡å·ä¸æ§½', "replace('programmingNoteFiles/Python/PySide6/1/2.html'); "],
          [true, 'ğŸ“˜ åˆ›å»ºç•Œé¢', "replace('programmingNoteFiles/Python/PySide6/1/3.html'); "],
          [true, 'ğŸ“˜ å¸ƒå±€ç®¡ç†', "replace('programmingNoteFiles/Python/PySide6/1/4.html'); "]
        ]],
        [false, 'ğŸ“ é«˜çº§æ•™ç¨‹', [
          [true, 'ğŸ“˜ Model/View æ¶æ„', "replace('programmingNoteFiles/Python/PySide6/2/1.html'); "],
          [true, 'ğŸ“˜ å¤šçº¿ç¨‹', "replace('programmingNoteFiles/Python/PySide6/2/2.html'); "],
          [true, 'ğŸ“˜ æ ·å¼è¡¨', "replace('programmingNoteFiles/Python/PySide6/2/3.html'); "],
          [true, 'ğŸ“˜ å¯¹è¯æ¡†', "replace('programmingNoteFiles/Python/PySide6/2/4.html'); "]
        ]],
        [true, 'ğŸ“˜ æ§ä»¶ä¸€è§ˆè¡¨', "replace('programmingNoteFiles/Python/PySide6/1.html'); "]
      ]],
      [false, 'ğŸ“ Tkinter', [
        [true, 'ğŸ“˜ æš‚æ— ç¬”è®°', ""]
      ]]
    ]],
    [false, 'ğŸ“ HTML', [
      [false, 'ğŸ“ æ ‡ç­¾', [
        [true, 'ğŸ“˜ æš‚æ— ç¬”è®°', ""]
      ]]
    ]],
    [false, 'ğŸ“ JavaScript', [
      [true, 'ğŸ“˜ æš‚æ— ç¬”è®°', ""]
    ]],
    [false, 'ğŸ“ CSS', [
      [true, 'ğŸ“˜ æš‚æ— ç¬”è®°', ""]
    ]]]],
  [true, 'ğŸ’¬ è”ç³»æ–¹å¼', "replace('contact.html'); "],
  [false, 'ğŸ’» å…¶ä»–å·¥å…·', [
    [false, 'ğŸ“’ è‹±è¯­å•è¯æœ¬', [
      [true, 'ğŸ“˜ 2025å¹´ä¸‹', "replace('other/words-notebook/2025-1.html'); "]
    ]]
  ]],
  [false, 'ğŸ“„ å¸®åŠ©æ–‡æ¡£', [
    [true, 'ğŸ“‹ æ›´æ–°æ—¥å¿—', "replace('help/log.html'); "],
    [true, 'ğŸ“œ å¼€æºè®¸å¯', "replace('help/license.html'); "]
  ]]
];

let path = [];
let subject = 'light';
const urlObject = new URL(window.location.href);


function replace(url) {
  const urlObject = new URL(window.location.href + url);
  urlObject.searchParams.set('page', url);
  urlObject.searchParams.set('path', path.toString());
  closeSidebar();
  window.location.replace(urlObject.toString());
}


function closeSidebar() {
  const sidebar = document.querySelector('.sidebar');
  const overlay = document.querySelector('.overlay');
  for (let i = 0; i < 19; i++) {
    eval(`setTimeout(() => { sidebar.style.left = '${-i - 1}rem'; }, ${i * 10 + 10}); `);
  }
  setTimeout(() => { sidebar.style.display = 'none'; }, 200);
  setTimeout(() => { overlay.style.display = 'none'; }, 200);
}

function openSidebar() {
  const sidebar = document.querySelector('.sidebar');
  const overlay = document.querySelector('.overlay');
  sidebar.style.display = 'block';
  overlay.style.display = 'block';
  for (let i = 0; i < 19; i++) {
    eval(`setTimeout(() => { sidebar.style.left = '${i - 19}rem'; }, ${i * 10 + 10}); `);
  }
}

function enter(option) {
  let list = [...sidebarTitlesArray];
  for (let item of path) {
    list = list[item];
    list = list[2];
  }
  for (let item = 0; item < list.length; item++) {
    if (list[item][1] == option) {
      path.push(item);
      break;
    }
  }
  sidebarCodeConfig();
}

function sidebarCodeConfig() {
  const notesList = document.querySelector('.sidebar ul');
  let list = [...sidebarTitlesArray];
  let text = path.length == 0 ? '' : '<li onclick="returnToTheLastOne(); " style="text-align: left; line-height: 2rem; cursor: pointer; padding-left: 0;">â† è¿”å›</li>';
  for (let item of path) {
    list = list[item];
    list = list[2];
  }
  for (let item of list) {
    if (item[0]) {
      text += `<li onclick="${item[2]}">${item[1]}</li>`;
    } else {
      text += `<li onclick="enter('${item[1]}'); "><div class="li"><div class="left-content">${item[1]}</div><div class="right-content">&gt;</div></div></li>`;
    }
  }
  notesList.innerHTML = text;
}

function returnToTheLastOne() {
  path.pop();
  sidebarCodeConfig();
}

function subjectConfig() {
  const subjectButton = document.querySelector('.subjectButton');
  subject = subject == 'light' ? 'dark' : 'light';
  document.documentElement.setAttribute('data-subject', subject);
  subjectButton.innerHTML = subject == 'light' ? 'â˜€ï¸' : 'ğŸŒ™';
  localStorage.setItem('trueib-subject', subject);
  sendSubjectToIframe();
}

function sendSubjectToIframe() {
  const iframe = document.querySelector('.htmlDisplayArea');
  iframe.contentWindow.postMessage({
    type: 'THEME_CHANGE',
    subject: subject
  }, "*");
}


document.addEventListener('DOMContentLoaded', () => {
  const body = document.querySelector('body');
  if (urlObject.searchParams.get('page') == null) {
    urlObject.searchParams.set('page', 'home.html');
    body.innerHTML = '';
    window.location.replace(urlObject.toString());
  } else {
    subject = localStorage.getItem("trueib-subject") ? localStorage.getItem("trueib-subject") : subject;
    document.documentElement.setAttribute("data-subject", subject);
    body.innerHTML = `<header class="header"><div class="left-content">&nbsp;&nbsp;<b class="menuButton" onclick="openSidebar(); ">â˜°</b>&nbsp;&nbsp;&nbsp;TrueIB</div><div class="right-content"><b class="subjectButton" onclick="subjectConfig(); ">${subject == 'dark' ? 'ğŸŒ™' : 'â˜€ï¸'}</b>&nbsp;&nbsp;</div></header><div class="overlay" onclick="closeSidebar(); "></div><div class="sidebar"><div class="closeButton" onclick="closeSidebar(); ">Ã—</div><div style="padding: 20px;"><h1>TrueIB</h1><ul></ul></div></div>` + body.innerHTML;
    const iframe = document.querySelector('.htmlDisplayArea');
    iframe.setAttribute('src', urlObject.searchParams.get('page'));
    if (urlObject.searchParams.get('path') != null && urlObject.searchParams.get('path') != '') {
      path = urlObject.searchParams.get('path').split(',').map(Number);
    }
    sidebarCodeConfig();
  }
});
